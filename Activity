using System;
using System.Collections.Generic;

class Program
{
    enum InsuranceType
    {
        None = 0,
        Basic = 20,
        Premium = 50,
        Corporate = 80
    }

    enum AgeCategory
    {
        Child,
        Adult,
        Senior,
        SuperSenior
    }

    static void Main()
    {
        // Services
        Dictionary<int, double> services = new Dictionary<int, double>
        {
            {1, 500},   // Lab Test
            {2, 1000},  // X-Ray
            {3, 800},   // ECG
            {4, 5000}   // MRI
        };

        Console.WriteLine("=== Hospital Billing System ===");

        // Age input
        Console.Write("Enter Age: ");
        int age = int.Parse(Console.ReadLine());

        AgeCategory ageCategory = GetAgeCategory(age);

        // Consultation fee
        Console.Write("Enter Consultation Fee: ");
        double consultationFee = double.Parse(Console.ReadLine());

        Console.WriteLine("\nAvailable Services:");
        Console.WriteLine("1. Lab Test - ₹500");
        Console.WriteLine("2. X-Ray - ₹1000");
        Console.WriteLine("3. ECG - ₹800");
        Console.WriteLine("4. MRI - ₹5000");

        Console.Write("\nHow many services taken? ");
        int serviceCount = int.Parse(Console.ReadLine());

        double serviceTotal = 0;

        for (int i = 0; i < serviceCount; i++)
        {
            Console.Write("Enter service number: ");
            int choice = int.Parse(Console.ReadLine());

            if (services.ContainsKey(choice))
            {
                serviceTotal += services[choice];
            }
            else
            {
                Console.WriteLine("Invalid service!");
                i--;
            }
        }

        double subTotal = consultationFee + serviceTotal;

        // Base discount
        double baseDiscount = subTotal > 2000 ? subTotal * 0.05 : 0;
        double afterBaseDiscount = subTotal - baseDiscount;

        // Insurance
        Console.WriteLine("\nInsurance Type:");
        Console.WriteLine("0. None");
        Console.WriteLine("1. Basic");
        Console.WriteLine("2. Premium");
        Console.WriteLine("3. Corporate");
        int insuranceInput = int.Parse(Console.ReadLine());

        InsuranceType insurance = (InsuranceType)insuranceInput;
        double insuranceDiscount = afterBaseDiscount * ((int)insurance / 100.0);

        // Age based discount
        double ageDiscount = CalculateAgeDiscount(afterBaseDiscount, ageCategory);

        // Stay charges
        Console.Write("\nEnter Hospital Stay Days: ");
        int days = int.Parse(Console.ReadLine());
        double stayCharges = days * 1000;

        // Tax
        double tax = (afterBaseDiscount + stayCharges) * 0.12;

        double finalAmount =
            afterBaseDiscount + stayCharges + tax
            - insuranceDiscount - ageDiscount;

        string billId = GenerateBillId();

        // Final Bill
        Console.WriteLine("\n========= FINAL BILL =========");
        Console.WriteLine($"Bill ID: {billId}");
        Console.WriteLine($"Age: {age} ({ageCategory})");
        Console.WriteLine($"Consultation Fee: ₹{consultationFee}");
        Console.WriteLine($"Service Charges: ₹{serviceTotal}");
        Console.WriteLine($"Base Discount: ₹{baseDiscount}");
        Console.WriteLine($"Insurance Discount: ₹{insuranceDiscount}");
        Console.WriteLine($"Age Discount: ₹{ageDiscount}");
        Console.WriteLine($"Stay Charges: ₹{stayCharges}");
        Console.WriteLine($"Tax: ₹{tax}");
        Console.WriteLine($"Final Amount to Pay: ₹{finalAmount}");
        Console.WriteLine("==============================");
    }

    // Age category logic (MULTIPLE CASES)
    static AgeCategory GetAgeCategory(int age)
    {
        if (age <= 12) return AgeCategory.Child;
        if (age <= 59) return AgeCategory.Adult;
        if (age <= 79) return AgeCategory.Senior;
        return AgeCategory.SuperSenior;
    }

    static double CalculateAgeDiscount(double amount, AgeCategory category)
    {
        switch (category)
        {
            case AgeCategory.Child:
                return amount * 0.15;
            case AgeCategory.Senior:
                return amount * 0.10;
            case AgeCategory.SuperSenior:
                return amount * 0.20;
            default:
                return 0;
        }
    }

    static string GenerateBillId()
    {
        return "BILL-" + DateTime.Now.ToString("yyyyMMddHHmmss");
    }
}
